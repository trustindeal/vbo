<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VBO Sheet Viewer</title>

  <!-- Modern Clean UI Using Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">

  <h2 class="text-3xl font-bold text-center mb-4 text-gray-800">VBO Sheet Data</h2>

  <div class="text-center mb-4">
    <button id="refreshBtn" onclick="loadData()"
      class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl shadow-md text-lg">
      REFRESH
    </button>
  </div>

  <div id="mainCards" class="space-y-6"></div>

  <h3 class="text-2xl font-semibold text-center mt-10 mb-3 text-gray-700">User List</h3>
  <div id="userList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

  <script>
    const sheetCSV = "https://docs.google.com/spreadsheets/d/1WzR7qR-AAJup_hzNCHIC1fxYsVR_RSxR2mAZ7FcMWcM/export?format=csv&gid=0";

    async function loadData() {
      document.getElementById("mainCards").innerHTML = "<p class='text-center text-gray-600'>Loading...</p>";
      document.getElementById("userList").innerHTML = "";

      const res = await fetch(sheetCSV);
      const data = await res.text();
      const rows = data.split("\n").map(r => r.split(","));

      let cardsHTML = "";
      let userHTML = "";

      rows.forEach((r, i) => {
        if (i === 0) return; // No header, but still skip first blank/format row

        // MAIN CARD FIELDS BASED ON PROVIDED COLUMNS
        const A = r[0] || "";   // Time
        const C = r[2] || "";   // Tag by
        const D = r[3] || "";   // Location
        const E = r[4] || "";   // JC pic link
        const F = r[5] || "";   // Pole pic
        const G = r[6] || "";   // Line Name
        const H = r[7] || "";   // Splitter
        const I = r[8] || "";   // Fiber
        const O = r[14] || "";  // Window
        const P = r[15] || "";  // Tag ID
        const EY = r[24] || ""; // Total users (Y index = 24)
        const EZ = r[25] || ""; // Offline users
        const FA = r[26] || ""; // Online users
        const FB = r[27] || ""; // Splitter status

        // CARD UI
        cardsHTML += `
          <div class="bg-white p-6 rounded-2xl shadow-md max-w-2xl mx-auto border border-gray-200">
            <div class="grid grid-cols-2 gap-3 text-gray-800 text-base">
              <p><span class='font-semibold'>Time:</span> ${A}</p>
              <p><span class='font-semibold'>Tag By:</span> ${C}</p>
              <p><span class='font-semibold'>Location:</span> ${D}</p>
              <p><span class='font-semibold'>Line Name:</span> ${G}</p>
              <p><span class='font-semibold'>Splitter:</span> ${H}</p>
              <p><span class='font-semibold'>Fiber:</span> ${I}</p>
              <p><span class='font-semibold'>Window:</span> ${O}</p>
              <p><span class='font-semibold'>Tag ID:</span> ${P}</p>
              <p><span class='font-semibold'>Total Users:</span> ${EY}</p>
              <p><span class='font-semibold'>Offline Users:</span> ${EZ}</p>
              <p><span class='font-semibold'>Online Users:</span> ${FA}</p>
              <p><span class='font-semibold'>Splitter Status:</span> ${FB}</p>
            </div>
            <div class="mt-4 flex gap-4">
              <a href="${E}" target="_blank" class="text-blue-600 underline">JC Pic</a>
              <a href="${F}" target="_blank" class="text-blue-600 underline">Pole Pic</a>
            </div>
          </div>`;

        // USER LIST (Y to EV = 24 to 80 approx)
        let users = r.slice(24, 80).filter(x => x.trim() !== "");
        if (users.length > 0) {
          users.forEach(u => {
            userHTML += `
              <div class="bg-white p-4 rounded-xl shadow border border-gray-200">${u}</div>
            `;
          });
        }
      });

      document.getElementById("mainCards").innerHTML = cardsHTML;
      document.getElementById("userList").innerHTML = userHTML;
    }

    loadData();
  </script>

</body>
</html>
