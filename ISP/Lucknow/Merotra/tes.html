<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=0.5, user-scalable=yes">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f6f8;
      color: #333;
      height: 100vh;
      overflow: hidden;
    }

    a { text-decoration: none !important; }

    .header {
      text-align: center;
      margin: 10px 0;
      position: relative;
    }

    .logout-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      color: #fff;
      background-color: #e74c3c;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .container {
      max-width: 100%;
      margin: 0;
      background: linear-gradient(145deg, #ffffff, #f0f2f5);
      padding: 10px;
      height: 100vh;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .right-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      flex-grow: 1;
      overflow: auto;
    }

    /* ---------- AUTO SCALE IFRAME CONTENT ---------- */

    .iframe-wrapper {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    /* Desktop */
    .iframe-wrapper iframe {
      width: 100%;
      height: 100%;
      transform-origin: top left;
    }

    /* Mobile Scaling */
    @media(max-width: 768px) {
      .iframe-wrapper iframe {
        transform: scale(0.80);
        width: 125%;
        height: 125%;
      }
    }

    /* Very Small Screens */
    @media(max-width: 400px) {
      .iframe-wrapper iframe {
        transform: scale(0.72);
        width: 138%;
        height: 138%;
      }
    }

    /* ---------- TAB SYSTEM ---------- */

    .tab-bar {
      display: flex;
      overflow-x: auto;
      background: linear-gradient(145deg, #ffffff, #f0f2f5);
      margin-bottom: 10px;
      padding: 5px;
      border-bottom: 1px solid #e0e4e8;
      flex-shrink: 0;
    }

    .tab-btn {
      padding: 8px 15px;
      white-space: nowrap;
      font-size: 0.9rem;
      cursor: pointer;
      margin-right: 2px;
      border-radius: 8px 8px 0 0;
      background: transparent;
      border: 1px solid transparent;
      opacity: 0;
      transform: translateX(-100%);
      animation: flyInTab 1s ease forwards;
    }

    @keyframes flyInTab {
      to { opacity: 1; transform: translateX(0); }
    }

    .tab-btn.active {
      background: #ffffff;
      border: 1px solid #e0e4e8;
      border-bottom: none;
    }

    .close-tab {
      margin-left: 8px;
      cursor: pointer;
    }

    .tab-content {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: calc(100% - 30px);
      padding: 20px;
      box-sizing: border-box;
      overflow: auto;
      opacity: 0;
      transform: translateX(-100%);
      transition: opacity 1.2s ease, transform 1.2s ease;
    }

    .tab-content.active {
      opacity: 1;
      transform: translateX(0);
      position: relative;
    }

  </style>
</head>

<body>
  <header class="header">
    <button class="logout-btn" onclick="logout()">Logout</button>
  </header>

  <div class="container">
    <div class="tab-bar" id="tab-bar"></div>
    <div id="tab-contents" class="tab-contents" style="position:relative;width:100%;flex-grow:1;overflow:hidden;">
      <!-- HOME TAB CONTENT -->
      <div id="home-content" class="tab-content active">

        <div class="right-grid">

          <!-- INTERNET -->
          <div>
            <div class="right-button btn-internet clickable" onclick="toggleOptions(this)">
              <i class="bi bi-router-fill"></i> Internet
            </div>

            <div class="dropdown-options">
              <a class="right-button btn-internet right-button-small clickable"
                 href="#" onclick="openTab('https://virtualbackoffice2.github.io/rack/', 'Rack & PONs'); return false;">
                <i class="bi bi-card-checklist"></i> Rack & PONs
              </a>

              <a class="right-button btn-internet right-button-small clickable"
                 href="#" onclick="openTab('https://virtualbackoffice2.github.io/rack/off/', 'Complain Handle'); return false;">
                <i class="bi bi-card-checklist"></i> Mark Complain
              </a>

              <a class="right-button btn-internet right-button-small clickable"
                 href="https://del-desk.excitel.in/" target="_blank">
                <i class="bi bi-person-square"></i> Procare Login
              </a>

              <a class="right-button btn-internet right-button-small clickable"
                 href="#" onclick="openTab('https://vbo.co.in/ISP/Lucknow/Merotra/tag', 'Splitter Tagging Report'); return false;">
                <i class="bi bi-slash-circle"></i> Splitter tagging report
              </a>
            </div>
          </div>


          <!-- CABLE -->
          <div>
            <div class="right-button btn-cable clickable" onclick="toggleOptions(this)">
              <i class="bi bi-tv"></i> Cable
            </div>

            <div class="dropdown-options">
              <a class="right-button btn-cable right-button-small clickable"
                 href="https://docs.google.com/spreadsheets/d/1DkIP-IHouSQjilvSs43IkMAZLMdXr3sEYeNBsCDjdOc/edit?gid=2052862460#gid=2052862460"
                 target="_blank">
                 <i class="bi bi-table"></i> Due Payment Schedules
              </a>

              <a class="right-button btn-cable right-button-small clickable"
                 href="https://docs.google.com/spreadsheets/d/1Hp8zcOmRT0ZkFt__zXG3YSXlDiTKwOTIHdJuIRdX3uI/edit?gid=0#gid=0"
                 target="_blank">
                 <i class="bi bi-exclamation-circle"></i> Mark Complain
              </a>

              <a class="right-button btn-cable right-button-small clickable"
                 href="https://docs.google.com/spreadsheets/d/1H0ffjhT51ES7a0jcGUUMsfUa5_fA3y1mvVjKZGVnHDc/edit?gid=216128426#gid=216128426"
                 target="_blank">
                 <i class="bi bi-wallet2"></i> Recharge Sheet
              </a>

              <a class="right-button btn-cable right-button-small clickable"
                 href="https://partners.denonline.in/login.aspx" target="_blank">
                 <i class="bi bi-person-square"></i> Den Login
              </a>
            </div>
          </div>


          <!-- ADMIN -->
          <div>
            <div class="right-button btn-admin clickable" onclick="toggleOptions(this)">
              <i class="bi bi-buildings-fill"></i> Administration
            </div>

            <div class="dropdown-options">

              <a class="right-button btn-admin right-button-small clickable"
                href="https://script.google.com/macros/s/AKfycbzI3zNPDSRNadTLXygYsEW7CyK3L0Wfn3x8vXiFxUrbBzoNk3E-LZwKF0nFH2WfXQsqLw/exec?page=mehrotranetwork"
                target="_blank">
                <i class="bi bi-person-badge"></i> Manager Dashboard
              </a>

              <a class="right-button btn-admin right-button-small clickable"
                href="https://script.google.com/macros/s/AKfycbyU0-_cPkzR8o3NH7g-JiAd1ZgtGUq-kqK2i4LeIt7hEGbvPeP4xt-y41iUhmojtYSKmQ/exec"
                target="_blank">
                <i class="bi bi-people"></i> Team Dashboard
              </a>

              <a class="right-button btn-admin right-button-small clickable"
                href="#" onclick="openTab('https://virtualbackoffice2.github.io/rack/atnr', 'Attendance'); return false;">
                <i class="bi bi-journal-richtext"></i> Check attendance
              </a>

              <a class="right-button btn-admin right-button-small clickable"
                href="https://docs.google.com/spreadsheets/d/15k3YqOk3WuUB9jPwe86sM3B8hxY-rKJ7ryg4WstH4Z8/edit?gid=1106289681#gid=1106289681"
                target="_blank">
                <i class="bi bi-journal-richtext"></i> Payroll
              </a>

              <div class="right-button btn-admin right-button-small btn-disabled"
                onclick="playErrorSound()">
                <i class="bi bi-bar-chart-line"></i> Financial Reports
              </div>

            </div>
          </div>


          <!-- STOCK -->
          <div>
            <div class="right-button btn-stock clickable" onclick="toggleOptions(this)">
              <i class="bi bi-box-arrow-in-down"></i> Stock
            </div>

            <div class="dropdown-options">
              <div class="right-button btn-stock right-button-small btn-disabled" onclick="playErrorSound()">
                <i class="bi bi-journals"></i> Stock Book
              </div>

              <div class="right-button btn-stock right-button-small btn-disabled" onclick="playErrorSound()">
                <i class="bi bi-graph-up"></i> Set Stock Levels
              </div>
            </div>
          </div>

        </div>
<script>

  function toggleOptions(clickedBtn) {
    const allDropdowns = document.querySelectorAll(".dropdown-options");
    allDropdowns.forEach(drop => {
      if (drop !== clickedBtn.nextElementSibling) drop.classList.remove("show");
    });
    clickedBtn.nextElementSibling.classList.toggle("show");
  }

  function playErrorSound() {
    document.getElementById("errorSound").play();
    const popup = document.getElementById("popupMessage");
    popup.classList.add("show");
    setTimeout(() => popup.classList.remove("show"), 2000);
  }


  /* ------------------- TAB SYSTEM ------------------- */

  let tabIdCounter = 0;
  const tabs = [];

  function initTabs() {
    const homeId = tabIdCounter++;

    const homeBtn = document.createElement('div');
    homeBtn.className = 'tab-btn active';
    homeBtn.textContent = 'Home';
    homeBtn.onclick = () => switchTab(homeId);

    document.getElementById('tab-bar').appendChild(homeBtn);

    const homeContent = document.getElementById('home-content');
    homeContent.classList.add('tab-content', 'active');

    tabs.push({
      id: homeId,
      btn: homeBtn,
      content: homeContent,
      isHome: true
    });
  }


  function openTab(url, title) {

    if (url.includes('docs.google.com') ||
        url.includes('del-desk.excitel.in') ||
        url.includes('partners.denonline.in')) {

      window.open(url, '_blank');
      return;
    }

    const tabId = tabIdCounter++;

    /* Create TAB Button */
    const tabBtn = document.createElement('div');
    tabBtn.className = 'tab-btn';
    tabBtn.textContent = title;

    const closeSpan = document.createElement('span');
    closeSpan.className = 'close-tab';
    closeSpan.textContent = 'Ã—';

    closeSpan.onclick = (e) => {
      e.stopPropagation();
      closeTab(tabId);
    };

    tabBtn.appendChild(closeSpan);
    tabBtn.onclick = () => switchTab(tabId);

    document.getElementById('tab-bar').appendChild(tabBtn);


    /* Create TAB Content */
    const contentDiv = document.createElement('div');
    contentDiv.className = 'tab-content';
    contentDiv.style.position = 'absolute';
    contentDiv.style.top = 0;
    contentDiv.style.left = 0;
    contentDiv.style.width = '100%';
    contentDiv.style.height = '100%';
    contentDiv.style.display = 'none';
    contentDiv.style.overflow = 'auto';


    /* -------------------- UPDATED IFRAME WRAPPER -------------------- */

    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.style.display = 'block';

    iframe.setAttribute('sandbox',
      'allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-downloads allow-web-share');

    // WRAPPER ADDED
    const wrapper = document.createElement('div');
    wrapper.classList.add("iframe-wrapper");
    wrapper.appendChild(iframe);

    contentDiv.appendChild(wrapper);


    // Fallback for blocked websites
    iframe.onerror = function () {
      contentDiv.innerHTML = '';
      const fallbackLink = document.createElement('a');
      fallbackLink.href = url;
      fallbackLink.target = '_blank';
      fallbackLink.textContent = 'This site cannot be displayed. Click to open.';
      fallbackLink.style.display = 'block';
      fallbackLink.style.padding = '20px';
      fallbackLink.style.textAlign = 'center';
      contentDiv.appendChild(fallbackLink);
    };


    document.getElementById('tab-contents').appendChild(contentDiv);

    tabs.push({ id: tabId, btn: tabBtn, content: contentDiv, isHome: false });

    switchTab(tabId);
  }



  function switchTab(tabId) {
    tabs.forEach(tab => {
      tab.content.style.display = 'none';
      tab.btn.classList.remove('active');
      tab.content.classList.remove('active');
    });

    const tab = tabs.find(t => t.id === tabId);
    if (tab) {
      tab.content.style.display = 'block';
      tab.btn.classList.add('active');
      tab.content.classList.add('active');
    }
  }



  function closeTab(tabId) {
    const index = tabs.findIndex(t => t.id === tabId);
    if (index === -1 || tabs[index].isHome) return;

    const tab = tabs[index];

    tab.content.style.opacity = '0';
    tab.content.style.transform = 'translateX(20px)';
    tab.btn.style.opacity = '0';
    tab.btn.style.transform = 'translateX(20px)';

    setTimeout(() => {
      tab.btn.remove();
      tab.content.remove();
      tabs.splice(index, 1);

      if (tabs.length > 0) {
        switchTab(tabs[Math.max(0, index - 1)].id);
      }
    }, 800);
  }



  function logout() {
    localStorage.clear();
    sessionStorage.clear();
    window.location.href = "https://vbo.co.in";
  }


  window.addEventListener('load', () => {
    initTabs();
  });

</script>
